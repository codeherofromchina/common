<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.erui.report.dao.CommonMapper">

    <!--国家列表-->
    <select id="countryList" parameterType="java.util.Map" resultType="java.util.Map">
        select bn as countryBn,`name` as countryName from erui_dict.country as t1 where t1.lang='zh' and t1.deleted_flag='N'
        <if test="areaBn!=null and areaBn!=''" >
            and region_bn = #{areaBn}
        </if>
    </select>

    <!--地区列表-->
    <select id="areaList" parameterType="java.util.Map" resultType="java.util.Map">
        select bn as areaBn,`name` as areaName from erui_operation.market_area t1 where t1.lang='zh' AND t1.deleted_flag='N'
    </select>


    <!--事业部列表-->
    <select id="orgList" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
        id, `name` AS orgName
        FROM
        erui_sys.org
        WHERE
        deleted_flag = 'N'
        AND `status` = 'NORMAL'
    </select>

    <!--事业部根据ID查找名称-->
    <select id="findOrgInfoById" parameterType="java.lang.Integer" resultType="java.util.Map">
        SELECT
        id as orgId, `name` AS orgName
        FROM
        erui_sys.org
        WHERE
        deleted_flag = 'N'
        AND `status` = 'NORMAL'
        AND id = #{orgId}
    </select>

    <!--国家编码查找国家名称和地区信息-->
    <select id="findCountryInfoByBn" parameterType="java.lang.String" resultType="java.util.Map">
        SELECT
            t1.bn AS countryBn,
            t1.`name` AS countryName,
            t1.region_bn AS areaBn,
            t2.`name` AS areaName
        FROM
            erui_dict.country AS t1
                LEFT JOIN
            erui_operation.market_area t2 ON t1.region_bn = t2.bn AND t2.lang = 'zh'
        WHERE
            t1.lang = 'zh' AND t1.deleted_flag = 'N'
                AND t1.bn = #{countryBn}
    </select>
</mapper>